import{d as S,u as b,s as k,r as v,o as N,c as B,a as D,b as C,e as $,f as a,g as E,w as M,h as O,i as z,j as y,v as G,k as x}from"./index-DS78BICj.js";const V={class:"graph-editor"},j=S({__name:"GraphEditor",setup(_){const g=b(),{editorGraphObj:u}=k(g);let c=null;const d=v(null);let e=null,m=v(0);const h=()=>{if(!e)return;const o=e.nodes().map(s=>({id:s.id(),x:Math.round(s.position().x),y:Math.round(s.position().y)})),t=e.edges().map(s=>({source:s.source().id(),target:s.target().id()})),r={nodes:o,startEdges:t,targetEdges:t,steps:[]};u.value=r};function I(){if(!e)return;const o=e.nodes().sort((n,i)=>n.id().localeCompare(i.id())),t=new Map,r=[];o.forEach(n=>{t.set(n.id(),n.position())}),e.edges().forEach(n=>{r.push({source:n.source().id(),target:n.target().id()})}),e.elements().remove();const s=[];o.forEach((n,i)=>{const f=String.fromCharCode(97+i),p=t.get(n.id());s.push({data:{id:f},position:p})}),e.add(s);const l=[];r.forEach(n=>{const i=Array.from(t.keys()).indexOf(n.source),f=Array.from(t.keys()).indexOf(n.target);if(i!==-1&&f!==-1){const p=String.fromCharCode(97+i),w=String.fromCharCode(97+f);l.push({data:{id:`${p}${w}`,source:p,target:w}})}}),e.add(l),m.value=o.length}return N(()=>{e=B({container:d.value,elements:[],style:[{selector:"node",style:{"background-color":a.nodeColor,width:a.nodeSize,height:a.nodeSize,label:"data(id)",color:a.textColor,"text-valign":"center","text-halign":"center","font-size":`${a.fontSize}px`,events:"yes"}},{selector:"node.selected",style:{"background-color":a.nodeColorHighlighted}},{selector:"edge",style:{width:a.edgeWidth,"line-color":a.edgeColor}}],layout:{name:"preset"},zoom:a.editorDefaultZoom,userZoomingEnabled:!0,userPanningEnabled:!0,autounselectify:!1,motionBlur:!1,boxSelectionEnabled:!0,wheelSensitivity:a.wheelSensitivity}),e.on("select","node",o=>{o.target.addClass("selected")}),e.on("unselect","node",o=>{o.target.removeClass("selected")}),c=o=>{if(o.code==="Space"){if(o.preventDefault(),!e)return;const t=String.fromCharCode(97+m.value),r=e.extent(),s=(r.x1+r.x2)/2,l=(r.y1+r.y2)/2,n={data:{id:t},position:{x:s,y:l}};e.add(n),m.value++,h()}if(o.code==="KeyE"){if(o.preventDefault(),!e)return;const t=e.nodes(":selected");if(t.length===2){const r=t[0],s=t[1],l=`${r.id()}${s.id()}`;if(e.getElementById(l).length===0){const i={data:{id:l,source:r.id(),target:s.id()}};e.add(i),h()}}}if(o.code==="Delete"||o.code==="Backspace"){if(o.preventDefault(),!e)return;const t=e.nodes(":selected");t.length>0&&(t.remove(),I(),h())}},document.addEventListener("keydown",c)}),D(()=>{c&&(document.removeEventListener("keydown",c),c=null),e&&(e.destroy(),e=null)}),(o,t)=>(E(),C("div",V,[$("div",{ref_key:"cyContainer",ref:d,class:"cy-container"},null,512)]))}}),K={class:"editor"},T=S({__name:"EditorView",setup(_){const g=b(),{editorGraphObj:u}=k(g);return(c,d)=>(E(),C("div",K,[y(u)?M((E(),C("input",{key:0,"onUpdate:modelValue":d[0]||(d[0]=e=>y(u).name=e),class:"graph-problem-name",placeholder:"untitled",onKeydown:d[1]||(d[1]=x(()=>{},["stop"])),onKeyup:d[2]||(d[2]=x(()=>{},["stop"])),onKeypress:d[3]||(d[3]=x(()=>{},["stop"]))},null,544)),[[G,y(u).name]]):O("",!0),z(j)]))}});export{T as default};
