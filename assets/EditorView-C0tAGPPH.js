import{d as x,u as E,s as w,r as v,o as N,c as B,a as D,b as S,e as b,f as r,g as _,w as $,h as M,i as O,v as z,j as y}from"./index-DCYtZZ2x.js";const G={class:"graph-editor"},j=x({__name:"GraphEditor",setup(k){const h=E(),{editorGraphObj:g}=w(h);let a=null;const c=v(null);let e=null,u=v(0);const f=()=>{if(!e)return;const t=e.nodes().map(d=>({id:d.id(),x:Math.round(d.position().x),y:Math.round(d.position().y)})),o=e.edges().map(d=>({source:d.source().id(),target:d.target().id()})),n={nodes:t,startEdges:o,targetEdges:o,steps:[]};g.value=n};function I(){if(!e)return;const t=e.nodes().sort((s,i)=>s.id().localeCompare(i.id())),o=new Map,n=[];t.forEach(s=>{o.set(s.id(),s.position())}),e.edges().forEach(s=>{n.push({source:s.source().id(),target:s.target().id()})}),e.elements().remove();const d=[];t.forEach((s,i)=>{const p=String.fromCharCode(97+i),m=o.get(s.id());d.push({data:{id:p},position:m})}),e.add(d);const l=[];n.forEach(s=>{const i=Array.from(o.keys()).indexOf(s.source),p=Array.from(o.keys()).indexOf(s.target);if(i!==-1&&p!==-1){const m=String.fromCharCode(97+i),C=String.fromCharCode(97+p);l.push({data:{id:`${m}${C}`,source:m,target:C}})}}),e.add(l),u.value=t.length}return N(()=>{e=B({container:c.value,elements:[],style:[{selector:"node",style:{"background-color":r.nodeColor,width:r.nodeSize,height:r.nodeSize,label:"data(id)",color:r.textColor,"text-valign":"center","text-halign":"center","font-size":`${r.fontSize}px`,events:"yes"}},{selector:"node.selected",style:{"background-color":r.nodeColorHighlighted}},{selector:"edge",style:{width:r.edgeWidth,"line-color":r.edgeColor,events:"yes"}},{selector:"edge.selected",style:{"line-color":r.nodeColorHighlighted}}],layout:{name:"preset"},zoom:r.editorDefaultZoom,userZoomingEnabled:!0,userPanningEnabled:!0,autounselectify:!1,motionBlur:!1,boxSelectionEnabled:!0,wheelSensitivity:r.wheelSensitivity}),e.on("select","node",t=>{t.target.addClass("selected")}),e.on("unselect","node",t=>{t.target.removeClass("selected")}),e.on("select","edge",t=>{t.target.addClass("selected")}),e.on("unselect","edge",t=>{t.target.removeClass("selected")}),a=t=>{if(t.code==="Space"){if(t.preventDefault(),!e)return;const o=String.fromCharCode(97+u.value),n=e.extent(),d=(n.x1+n.x2)/2,l=(n.y1+n.y2)/2,s={data:{id:o},position:{x:d,y:l}};e.add(s),u.value++,f()}if(t.code==="KeyE"){if(t.preventDefault(),!e)return;const o=e.nodes(":selected");if(o.length===2){const n=o[0],d=o[1],l=`${n.id()}${d.id()}`;if(e.getElementById(l).length===0){const i={data:{id:l,source:n.id(),target:d.id()}};e.add(i),f()}}}if(t.code==="Delete"||t.code==="Backspace"){if(t.preventDefault(),!e)return;const o=e.nodes(":selected"),n=e.edges(":selected");o.length>0&&(o.remove(),I(),f()),n.length>0&&(n.remove(),f())}},document.addEventListener("keydown",a)}),D(()=>{a&&(document.removeEventListener("keydown",a),a=null),e&&(e.destroy(),e=null)}),(t,o)=>(_(),S("div",G,[b("div",{ref_key:"cyContainer",ref:c,class:"cy-container"},null,512)]))}}),K={class:"editor"},T=x({__name:"EditorView",setup(k){const h=E(),{editorGraphObj:g}=w(h),a=v("");return $(a,c=>{g.value&&(g.value.name=c)}),(c,e)=>(_(),S("div",K,[M(b("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>a.value=u),class:"graph-problem-name",placeholder:"untitled",onKeydown:e[1]||(e[1]=y(()=>{},["stop"])),onKeyup:e[2]||(e[2]=y(()=>{},["stop"])),onKeypress:e[3]||(e[3]=y(()=>{},["stop"]))},null,544),[[z,a.value]]),O(j)]))}});export{T as default};
