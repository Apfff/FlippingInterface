import{d as E,u as w,s as C,r as v,o as N,c as B,a as D,b as S,e as b,f as d,g as _,w as $,h as M,i as O,v as z,j as y}from"./index-C_av-0P4.js";const G={class:"graph-editor"},j=E({__name:"GraphEditor",setup(k){const m=w(),{editorGraphObj:f}=C(m);let a=null;const c=v(null);let e=null,u=v(0);const h=()=>{if(!e)return;const o=e.nodes().map(s=>({id:s.id(),x:Math.round(s.position().x),y:Math.round(s.position().y)})),t=e.edges().map(s=>({source:s.source().id(),target:s.target().id()})),r={nodes:o,startEdges:t,targetEdges:t,steps:[]};f.value=r};function I(){if(!e)return;const o=e.nodes().sort((n,i)=>n.id().localeCompare(i.id())),t=new Map,r=[];o.forEach(n=>{t.set(n.id(),n.position())}),e.edges().forEach(n=>{r.push({source:n.source().id(),target:n.target().id()})}),e.elements().remove();const s=[];o.forEach((n,i)=>{const p=String.fromCharCode(97+i),g=t.get(n.id());s.push({data:{id:p},position:g})}),e.add(s);const l=[];r.forEach(n=>{const i=Array.from(t.keys()).indexOf(n.source),p=Array.from(t.keys()).indexOf(n.target);if(i!==-1&&p!==-1){const g=String.fromCharCode(97+i),x=String.fromCharCode(97+p);l.push({data:{id:`${g}${x}`,source:g,target:x}})}}),e.add(l),u.value=o.length}return N(()=>{e=B({container:c.value,elements:[],style:[{selector:"node",style:{"background-color":d.nodeColor,width:d.nodeSize,height:d.nodeSize,label:"data(id)",color:d.textColor,"text-valign":"center","text-halign":"center","font-size":`${d.fontSize}px`,events:"yes"}},{selector:"node.selected",style:{"background-color":d.nodeColorHighlighted}},{selector:"edge",style:{width:d.edgeWidth,"line-color":d.edgeColor}}],layout:{name:"preset"},zoom:d.editorDefaultZoom,userZoomingEnabled:!0,userPanningEnabled:!0,autounselectify:!1,motionBlur:!1,boxSelectionEnabled:!0,wheelSensitivity:d.wheelSensitivity}),e.on("select","node",o=>{o.target.addClass("selected")}),e.on("unselect","node",o=>{o.target.removeClass("selected")}),a=o=>{if(o.code==="Space"){if(o.preventDefault(),!e)return;const t=String.fromCharCode(97+u.value),r=e.extent(),s=(r.x1+r.x2)/2,l=(r.y1+r.y2)/2,n={data:{id:t},position:{x:s,y:l}};e.add(n),u.value++,h()}if(o.code==="KeyE"){if(o.preventDefault(),!e)return;const t=e.nodes(":selected");if(t.length===2){const r=t[0],s=t[1],l=`${r.id()}${s.id()}`;if(e.getElementById(l).length===0){const i={data:{id:l,source:r.id(),target:s.id()}};e.add(i),h()}}}if(o.code==="Delete"||o.code==="Backspace"){if(o.preventDefault(),!e)return;const t=e.nodes(":selected");t.length>0&&(t.remove(),I(),h())}},document.addEventListener("keydown",a)}),D(()=>{a&&(document.removeEventListener("keydown",a),a=null),e&&(e.destroy(),e=null)}),(o,t)=>(_(),S("div",G,[b("div",{ref_key:"cyContainer",ref:c,class:"cy-container"},null,512)]))}}),K={class:"editor"},T=E({__name:"EditorView",setup(k){const m=w(),{editorGraphObj:f}=C(m),a=v("");return $(a,c=>{f.value&&(f.value.name=c)}),(c,e)=>(_(),S("div",K,[M(b("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>a.value=u),class:"graph-problem-name",placeholder:"untitled",onKeydown:e[1]||(e[1]=y(()=>{},["stop"])),onKeyup:e[2]||(e[2]=y(()=>{},["stop"])),onKeypress:e[3]||(e[3]=y(()=>{},["stop"]))},null,544),[[z,a.value]]),O(j)]))}});export{T as default};
